<!--pages/detail/detail.wxml-->
<view class="detail-page">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="page-header">
    <view class="header-content">
      <view class="status-badge status-{{reminder.status}}">
        <text class="status-icon">{{statusConfig[reminder.status].icon}}</text>
        <text class="status-text">{{statusConfig[reminder.status].text}}</text>
      </view>
      <view class="reminder-title">{{reminder.title}}</view>
      <view class="reminder-meta">
        <text class="meta-item">
          <text class="icon">ğŸ“…</text>
          åˆ°æœŸï¼š{{expireDateText}}
        </text>
        <text class="meta-item" wx:if="{{reminder.remindDays > 0}}">
          <text class="icon">â°</text>
          æå‰{{reminder.remindDays}}å¤©æé†’
        </text>
      </view>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹ -->
  <scroll-view class="main-content" scroll-y>
    <!-- åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
    <view class="info-card">
      <view class="card-header">
        <text class="card-title">åŸºæœ¬ä¿¡æ¯</text>
        <button class="edit-btn" bindtap="editReminder">
          <text class="icon">âœï¸</text>
          ç¼–è¾‘
        </button>
      </view>
      
      <view class="info-list">
        <view class="info-item">
          <text class="info-label">æ ‡é¢˜</text>
          <text class="info-value">{{reminder.title}}</text>
        </view>
        
        <view class="info-item" wx:if="{{reminder.description}}">
          <text class="info-label">æè¿°</text>
          <text class="info-value">{{reminder.description}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">åˆ†ç±»</text>
          <view class="category-tag">
            <text class="category-icon">{{categoryInfo.icon}}</text>
            <text class="category-name">{{categoryInfo.name}}</text>
          </view>
        </view>
        
        <view class="info-item">
          <text class="info-label">åˆ°æœŸæ—¥æœŸ</text>
          <text class="info-value date-value">{{expireDateText}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">å‰©ä½™æ—¶é—´</text>
          <text class="info-value time-remaining {{timeRemainingClass}}">{{timeRemainingText}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">ä¼˜å…ˆçº§</text>
          <view class="priority-tag priority-{{reminder.priority}}">
            <text class="priority-icon">{{priorityConfig[reminder.priority].icon}}</text>
            <text class="priority-text">{{priorityConfig[reminder.priority].text}}</text>
          </view>
        </view>
        
        <view class="info-item" wx:if="{{reminder.tags && reminder.tags.length > 0}}">
          <text class="info-label">æ ‡ç­¾</text>
          <view class="tags-container">
            <text class="tag" wx:for="{{reminder.tags}}" wx:key="*this">{{item}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æé†’è®¾ç½®å¡ç‰‡ -->
    <view class="info-card">
      <view class="card-header">
        <text class="card-title">æé†’è®¾ç½®</text>
      </view>
      
      <view class="info-list">
        <view class="info-item">
          <text class="info-label">æé†’æ—¶é—´</text>
          <text class="info-value">{{reminder.remindTime}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">æå‰å¤©æ•°</text>
          <text class="info-value">{{reminder.remindDays}}å¤©</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">é‡å¤è®¾ç½®</text>
          <text class="info-value">{{repeatText}}</text>
        </view>
        
        <view class="info-item">
          <text class="info-label">å¾®ä¿¡é€šçŸ¥</text>
          <text class="info-value status-text {{reminder.enableWechatNotify ? 'enabled' : 'disabled'}}">
            {{reminder.enableWechatNotify ? 'å·²å¼€å¯' : 'å·²å…³é—­'}}
          </text>
        </view>
        
        <view class="info-item">
          <text class="info-label">åº”ç”¨é€šçŸ¥</text>
          <text class="info-value status-text {{reminder.enableAppNotify ? 'enabled' : 'disabled'}}">
            {{reminder.enableAppNotify ? 'å·²å¼€å¯' : 'å·²å…³é—­'}}
          </text>
        </view>
      </view>
    </view>

    <!-- å†å²è®°å½•å¡ç‰‡ -->
    <view class="info-card" wx:if="{{historyList.length > 0}}">
      <view class="card-header">
        <text class="card-title">æ“ä½œå†å²</text>
      </view>
      
      <view class="history-list">
        <view class="history-item" wx:for="{{historyList}}" wx:key="id">
          <view class="history-icon">
            <text class="icon">{{item.icon}}</text>
          </view>
          <view class="history-content">
            <text class="history-action">{{item.action}}</text>
            <text class="history-time">{{item.timeText}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- å¿«é€Ÿæ“ä½œå¡ç‰‡ -->
    <view class="info-card">
      <view class="card-header">
        <text class="card-title">å¿«é€Ÿæ“ä½œ</text>
      </view>
      
      <view class="quick-actions">
        <button class="action-btn" bindtap="markAsCompleted" wx:if="{{reminder.status !== 'completed'}}">
          <text class="btn-icon">âœ…</text>
          <text class="btn-text">æ ‡è®°å®Œæˆ</text>
        </button>
        
        <button class="action-btn" bindtap="snoozeReminder" wx:if="{{reminder.status === 'warning' || reminder.status === 'expired'}}">
          <text class="btn-icon">â°</text>
          <text class="btn-text">å»¶æœŸæé†’</text>
        </button>
        
        <button class="action-btn" bindtap="duplicateReminder">
          <text class="btn-icon">ğŸ“‹</text>
          <text class="btn-text">å¤åˆ¶æé†’</text>
        </button>
        
        <button class="action-btn" bindtap="shareReminder">
          <text class="btn-icon">ğŸ“¤</text>
          <text class="btn-text">åˆ†äº«</text>
        </button>
      </view>
    </view>

    <!-- ç›¸å…³å»ºè®® -->
    <view class="info-card" wx:if="{{suggestions.length > 0}}">
      <view class="card-header">
        <text class="card-title">ç›¸å…³å»ºè®®</text>
      </view>
      
      <view class="suggestions-list">
        <view class="suggestion-item" wx:for="{{suggestions}}" wx:key="id" bindtap="applySuggestion" data-suggestion="{{item}}">
          <view class="suggestion-icon">
            <text class="icon">{{item.icon}}</text>
          </view>
          <view class="suggestion-content">
            <text class="suggestion-title">{{item.title}}</text>
            <text class="suggestion-desc">{{item.description}}</text>
          </view>
          <view class="suggestion-arrow">
            <text class="icon">â†’</text>
          </view>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-actions">
    <button class="action-btn secondary" bindtap="editReminder">
      <text class="btn-icon">âœï¸</text>
      <text class="btn-text">ç¼–è¾‘</text>
    </button>
    
    <button class="action-btn danger" bindtap="deleteReminder">
      <text class="btn-icon">ğŸ—‘ï¸</text>
      <text class="btn-text">åˆ é™¤</text>
    </button>
  </view>

  <!-- å»¶æœŸé€‰æ‹©å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showSnoozeModal}}" bindtap="hideSnoozeModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">å»¶æœŸæé†’</text>
        <button class="modal-close" bindtap="hideSnoozeModal">Ã—</button>
      </view>
      
      <view class="modal-body">
        <view class="snooze-options">
          <button class="snooze-option" wx:for="{{snoozeOptions}}" wx:key="value" 
                  bindtap="selectSnooze" data-days="{{item.value}}">
            <text class="option-icon">{{item.icon}}</text>
            <text class="option-text">{{item.text}}</text>
          </button>
        </view>
        
        <view class="custom-snooze">
          <text class="custom-label">è‡ªå®šä¹‰å»¶æœŸå¤©æ•°ï¼š</text>
          <input class="custom-input" type="number" placeholder="è¾“å…¥å¤©æ•°" 
                 bindinput="onCustomSnoozeInput" value="{{customSnoozeDays}}" />
          <button class="custom-confirm" bindtap="confirmCustomSnooze" 
                  disabled="{{!customSnoozeDays}}">ç¡®å®š</button>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-overlay" wx:if="{{loading}}">
    <view class="loading-content">
      <view class="loading-spinner"></view>
      <text class="loading-text">{{loadingText}}</text>
    </view>
  </view>
</view>